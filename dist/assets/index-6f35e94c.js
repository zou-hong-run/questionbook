import{Z as K,m as X,T as Y,E as ee}from"./index-2710c44e.js";import{u as oe}from"./common-8e9d1b09.js";import{b as te}from"./question-396fa8fb.js";import{u as le}from"./question-cc3eeb2a.js";import{_ as ne,b as ae,u as se,a as re,c as r,C as ie,t as de,D as ue,d as f,o as S,e as $,n as g,h as a,i as s,g as v,l as c,G as ce,F as me,p as pe,q as he,y as q,x as _}from"./index-7bc7197a.js";import{c as fe}from"./websocket-51689666.js";const ge={class:"addQuestion"},ve={class:"addQuestion-title"},_e={class:"addQuestion-content"},ye={class:"addQuestion-bottom"},xe={class:"dialogbutton"},be={class:"dialog-footer"},Ce={__name:"index",setup(Ve){const I=ae();se();const E=re(),F=le(),D=fe();let y=F.category;y.length===0&&F.getQuestionType().then(e=>{y=e});const x=r(0),b=r(0),C=r(),U=r(),O=e=>{var o;(o=U.value)==null||o.setScrollTop(e)},R=({scrollTop:e})=>{b.value=e},z=e=>`${e} px`;K.registerModule(X);const T=r("default"),V=ie(),m=r("<p>hello</p>"),k=r("");de(()=>{var e,o;x.value=(o=(e=C.value)==null?void 0:e.box)==null?void 0:o.clientHeight,setTimeout(()=>{m.value='<h1 style="text-align: center;">我是问题标题内容哦</h1><hr/><p>我是你要输入的问题哦!同时我也支持markdown语法哦!</p><p style="text-align: left;">开始发出问题吧!!!!!!</p>'},1500)});const Q={modalAppendToBody:!1},M={maxLength:3333,placeholder:"请输入内容...",MENU_CONF:{insertImage:{onInsertedImage(e){if(e==null)return;const{src:o,alt:t,url:n,href:i}=e;console.log("inserted image",o,t,n,i)}},editImage:{onUpdatedImage(e){if(e==null)return;const{src:o,alt:t,url:n}=e;console.log("updated image",o,t,n)}},uploadImage:{async customUpload(e,o){oe(e).then(t=>{const{errno:n,data:i}=t;if(n!==0){alert("图片上传失败");return}const{alt:d,href:h,url:l}=i;k.value=k.value+l+",",o(l,d,h)}).catch(t=>{console.error(t)})},fieldName:"image",maxFileSize:1*1024*1024*10,maxNumberOfFiles:10,allowedFileTypes:["image/*"],meta:{},metaWithUrl:!1,withCredentials:!1,timeout:5*1e3,base64LimitSize:5*1024,onBeforeUpload(e){return console.log(e),e},onProgress(e){console.log("progress",e)},onSuccess(e,o){console.log(`${e.name} 上传成功`,o)},onFailed(e,o){console.log(`${e.name} 上传失败`,o)},onError(e,o,t){console.log(`${e.name} 上传出错`,o,t)}}}};ue(()=>{const e=V.value;e!=null&&e.destroy()});const N=e=>{V.value=e},L=e=>{var o,t;x.value=(t=(o=C.value)==null?void 0:o.box)==null?void 0:t.clientHeight},A=e=>{console.log("destroyed",e)},H=e=>{},P=e=>{},Z=(e,o)=>{alert(`【自定义提示】${o} - ${e}`)},G=(e,o,t)=>{console.log("ClipboardEvent 粘贴事件对象",o);const n=o.clipboardData.getData("text/plain");e.insertText(n),t(!1)},W=e=>{alert("内容过多了哦")},p=r(!1),u=r(null);function j(){if(!u.value){alert("标签没选");return}p.value=!1;let e=m.value.match(/<h1.*?>(.*?)<\/h1>/)[1],o=m.value,t=[];t.push({id:u.value.id}),te(e,o,t,k.value).then(n=>{_({title:"添加文章成功",position:"bottom-right",message:"ohohohohohohoh!!!!!!!!!",duration:2e3}),_({title:"添加文章成功",position:"top-right",message:"ohohohohohohoh!!!!!!!!!",duration:2e3}),_({title:"添加文章成功",position:"bottom-right",message:"ohohohohohohoh!!!!!!!!!",duration:2e3}),_({title:"添加文章成功",position:"bottom-left",message:"ohohohohohohoh!!!!!!!!!",duration:2e3}),_({title:"添加文章成功",position:"top-left",message:"ohohohohohohoh!!!!!!!!!",duration:2e3});let i=n.data;I.id;let d={data:{userId:{name:I.name},toUserId:null,message:{title:e},flag:"question",questionId:i}};const h=l=>{l.flag==="question"&&console.log("我发布问题了")};D.onsend(d,h),E.push(`/question/questionItem/${i}`)})}function J(e){console.log(e),u.value=e}return(e,o)=>{const t=f("el-text"),n=f("el-divider"),i=f("el-slider"),d=f("el-button"),h=f("el-dialog");return S(),$("div",ge,[g("div",ve,[a(n,{"content-position":"center"},{default:s(()=>[a(t,{type:"info",size:"large"},{default:s(()=>[c("发布问题")]),_:1})]),_:1})]),g("div",_e,[a(v(ce),{style:{height:"calc(100%)","z-index":"100"},ref_key:"scrollbarRef",ref:U,always:"",onScroll:R},{default:s(()=>[a(v(Y),{editor:v(V),defaultConfig:Q,mode:T.value,style:{"border-bottom":"5px solid #F5F6F8"}},null,8,["editor","mode"]),a(v(ee),{ref_key:"innerRef",ref:C,defaultConfig:M,mode:T.value,modelValue:m.value,"onUpdate:modelValue":o[0]||(o[0]=l=>m.value=l),onOnCreated:N,onOnChange:L,onOnDestroyed:A,onOnFocus:H,onOnBlur:P,onCustomAlert:Z,onCustomPaste:G,onOnMaxLength:W},null,8,["mode","modelValue"])]),_:1},512)]),g("div",ye,[a(i,{modelValue:b.value,"onUpdate:modelValue":o[1]||(o[1]=l=>b.value=l),max:x.value,"format-tooltip":z,onInput:O,size:"large",style:{width:"30%"}},null,8,["modelValue","max"]),a(d,{type:"primary",onClick:o[2]||(o[2]=l=>p.value=!0),size:"large"},{default:s(()=>[c("点击发布新问题!")]),_:1})]),a(h,{modelValue:p.value,"onUpdate:modelValue":o[5]||(o[5]=l=>p.value=l),title:"选择问题类别",width:"50%","align-center":""},{footer:s(()=>[g("span",be,[a(d,{onClick:o[4]||(o[4]=l=>p.value=!1)},{default:s(()=>[c("取消发布")]),_:1}),a(d,{type:"primary",onClick:j},{default:s(()=>[c(" 确定发布 ")]),_:1})])]),default:s(()=>[g("div",xe,[(S(!0),$(me,null,pe(v(y),(l,w)=>(S(),he(d,{modelValue:u.value,"onUpdate:modelValue":o[3]||(o[3]=B=>u.value=B),onClick:B=>J(l),key:w,size:"small"},{default:s(()=>[c(q(l.type),1)]),_:2},1032,["modelValue","onClick"]))),128))]),a(t,null,{default:s(()=>[c("选中标签:"+q(u.value?u.value.type:"还没有选择问题标签呢!"),1)]),_:1})]),_:1},8,["modelValue"])])}}},we=ne(Ce,[["__scopeId","data-v-8d5dd76c"]]);export{we as default};
