import{Z,m as G,T as W,E as J,u as Q}from"./common-b2c1eae8.js";import{a as X}from"./essay-3ba393fd.js";import{u as Y}from"./essay-2cab905f.js";import{_ as ee,c as r,C as te,t as le,D as oe,d as f,o as V,e as w,n as g,h as n,i as s,g as y,l as u,G as ae,F as ne,p as se,q as re,y as B}from"./index-d58f2316.js";const ie={class:"addEssay"},de={class:"addEssay-title"},ue={class:"addEssay-content"},ce={class:"addEssay-bottom"},me={class:"dialogbutton"},pe={class:"dialog-footer"},fe={__name:"index",setup(ge){let E=Y(),v=E.category;v.length===0&&E.getEssayType().then(e=>{v=e});const _=r(""),x=r(0),h=r(0),b=r(),F=r(),U=e=>{var t;(t=F.value)==null||t.setScrollTop(e)},I=({scrollTop:e})=>{h.value=e},$=e=>`${e} px`;Z.registerModule(G);const S=r("default"),C=te(),c=r("<p>hello</p>");le(()=>{var e,t;x.value=(t=(e=b.value)==null?void 0:e.box)==null?void 0:t.clientHeight,setTimeout(()=>{c.value='<h1 style="text-align: center;">我是文章标题内容哦</h1><hr/><p>我是你要输入的文章哦!</p><p>同时我也支持markdown语法哦!<img src="https://askbook-1317227518.cos.ap-beijing.myqcloud.com/askbook/images/eda2fefe-0cde-4445-b03a-ef831763f241.png" alt="header.png" data-href="" style="width: 58.00px;height: 58.00px;"/></p><ul><li style="text-align: left;">标题</li><li style="text-align: left;">列表 - + *</li><li style="text-align: left;">引用 &gt;</li><li style="text-align: left;">分割线 ---</li><li style="text-align: left;">代码块 ```js</li></ul><p style="text-align: left;">开始写作吧!!!!!!</p>'},1500)});const O={modalAppendToBody:!1},z={maxLength:3333,placeholder:"请输入内容...",MENU_CONF:{insertImage:{onInsertedImage(e){if(e==null)return;const{src:t,alt:l,url:a,href:p}=e;console.log("inserted image",t,l,a,p)}},editImage:{onUpdatedImage(e){if(e==null)return;const{src:t,alt:l,url:a}=e;console.log("updated image",t,l,a)}},uploadImage:{async customUpload(e,t){Q(e).then(l=>{const{errno:a,data:p}=l;if(a!==0){alert("图片上传失败");return}const{alt:d,href:k,url:o}=p;_.value=_.value+o+",",t(o,d,k)}).catch(l=>{console.error(l)})},base64LimitSize:5*1024,server:"images/uploadCos",fieldName:"image",maxFileSize:1*1024*1024*10,maxNumberOfFiles:10,allowedFileTypes:["image/*"],meta:{token:"xxx",otherKey:"yyy"},metaWithUrl:!1,headers:{Accept:"text/x-json",otherKey:"xxx"},withCredentials:!0,timeout:5*1e3,onBeforeUpload(e){return e},onProgress(e){console.log("progress",e)},onSuccess(e,t){console.log(`${e.name} 上传成功`,t)},onFailed(e,t){console.log(`${e.name} 上传失败`,t)},onError(e,t,l){console.log(`${e.name} 上传出错`,t,l)}}}};oe(()=>{const e=C.value;e!=null&&e.destroy()});const D=e=>{C.value=e},M=e=>{var t,l;x.value=(l=(t=b.value)==null?void 0:t.box)==null?void 0:l.clientHeight},R=e=>{console.log("destroyed",e)},L=e=>{},N=e=>{},A=(e,t)=>{alert(`【自定义提示】${t} - ${e}`)},j=(e,t,l)=>{console.log("ClipboardEvent 粘贴事件对象",t);const a=t.clipboardData.getData("text/plain");e.insertText(a),l(!1)},H=e=>{alert("内容过多了哦")},m=r(!1),i=r(null);function P(){if(!i.value){alert("标签没选");return}m.value=!1;let e=c.value.match(/<h1.*?>(.*?)<\/h1>/)[1],t=c.value,l=[];l.push({id:i.value.id}),X(e,t,_.value,l).then(a=>{console.log(a)})}function q(e){i.value=e}return(e,t)=>{const l=f("el-text"),a=f("el-divider"),p=f("el-slider"),d=f("el-button"),k=f("el-dialog");return V(),w("div",ie,[g("div",de,[n(a,{"content-position":"center"},{default:s(()=>[n(l,{type:"info",size:"large"},{default:s(()=>[u("发布文章")]),_:1})]),_:1})]),g("div",ue,[n(y(ae),{style:{height:"calc(100%)","z-index":"100"},ref_key:"scrollbarRef",ref:F,always:"",onScroll:I},{default:s(()=>[n(y(W),{editor:y(C),defaultConfig:O,mode:S.value,style:{"border-bottom":"5px solid #F5F6F8"}},null,8,["editor","mode"]),n(y(J),{ref_key:"innerRef",ref:b,defaultConfig:z,mode:S.value,modelValue:c.value,"onUpdate:modelValue":t[0]||(t[0]=o=>c.value=o),onOnCreated:D,onOnChange:M,onOnDestroyed:R,onOnFocus:L,onOnBlur:N,onCustomAlert:A,onCustomPaste:j,onOnMaxLength:H},null,8,["mode","modelValue"])]),_:1},512)]),g("div",ce,[n(p,{modelValue:h.value,"onUpdate:modelValue":t[1]||(t[1]=o=>h.value=o),max:x.value,"format-tooltip":$,onInput:U,size:"large",style:{width:"30%"}},null,8,["modelValue","max"]),n(d,{type:"primary",onClick:t[2]||(t[2]=o=>m.value=!0),size:"large"},{default:s(()=>[u("点击发布新文章!")]),_:1})]),n(k,{modelValue:m.value,"onUpdate:modelValue":t[5]||(t[5]=o=>m.value=o),title:"选择文章类别",width:"50%","align-center":""},{footer:s(()=>[g("span",pe,[n(d,{onClick:t[4]||(t[4]=o=>m.value=!1)},{default:s(()=>[u("取消发布")]),_:1}),n(d,{type:"primary",onClick:P},{default:s(()=>[u(" 确定发布 ")]),_:1})])]),default:s(()=>[g("div",me,[(V(!0),w(ne,null,se(y(v),(o,K)=>(V(),re(d,{modelValue:i.value,"onUpdate:modelValue":t[3]||(t[3]=T=>i.value=T),onClick:T=>q(o),key:K,size:"small"},{default:s(()=>[u(B(o.type),1)]),_:2},1032,["modelValue","onClick"]))),128))]),n(l,null,{default:s(()=>[u("选中标签:"+B(i.value?i.value.type:"还没有选择标签呢!"),1)]),_:1})]),_:1},8,["modelValue"])])}}},he=ee(fe,[["__scopeId","data-v-11a7b6a3"]]);export{he as default};
